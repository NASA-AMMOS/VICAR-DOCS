<HTML>
<HEAD><title>HTML Help for FICOR77</title></HEAD>
<BODY>
<H1>Help for FICOR77</H1>
<pre>
PURPOSE:

ficor77 is a Vicar applications program which removes vidicon <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A>
induced radiometric distortion from Voyager images.

EXECUTION STATEMENT:

    ficor77 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#inp">INP</A>=(PIC,C1,C2,...,D1,D2,...) <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#out">OUT</A>=OPIC  user-parameters...

The input files consist of the image to be corrected (PIC), radiometric
files (C1,C2,...) as generated by the program MJSPFCF, and dark-current
frames (D1,D2,...).  PIC must appear as the first input.  The remaining
input files may appear in any order.  At least one radiometric file and
dark-current frame must be specified.

PIC must be an 800x800 (geometrically uncorrected) Voyager image in byte
data format.  The dark-current may consist of a single frame or the sum
of multiple dark-current exposures (byte or halfword format).  If a
summed dark-current is input, the parameter <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#numdc">NUMDC</A> must be used to
specify the number of frames summed together.

The output file (OPIC) consists of the radiometrically corrected image.
OPIC is normally output in halfword data format.  To specify byte or
floating point output data format, use the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#oformat">OFORMAT</A> parameter to specify
BYTE or REAL.

BACKGROUND INFORMATION:

"ficor77" will radiometrically correct the input image, converting the input
DN values to some specified radiometric unit.  The program requires a
radiometric file containing calibration data acquired via the same <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A>
and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> position as the input image (PIC), and dark-current data acquired
via the same <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate.

The dark-current (offset) consists of thermally induced charge which must
be subtracted from the signal.  This charge accumulates on the vidicon,
and increases linearly with time.  Dark-current build-up occurs during the
time between frame erasure and read-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#out">out</A>.  It is therefore a function of
image <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate.  Also, simultaneous-exposure wide-angle frames will have
a greater dark-current build-up than normal-exposure frames since they
are read <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#out">out</A> during the next frame cycle (the narrow-angle frame is read
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#out">out</A> first).

To measure the dark-current, zero-exposure (dark-current) frames are
acquired during cruise and encounter.  Because the rate of dark-current
build-up is time variant and highly sensitive to temperature changes,
the user should specify a dark-current frame with an FDS time reasonably
close to the FDS time of the input image.

The radiometric file contains calibration data obtained from a light-transfer
sequence (see program MJSPFCF for details).  For each pixel, the file
contains the nominal <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> output S0,S1,S2,...,Sn (in units of DN) at each
of a sequence of exposures E0,E1,E2,...,En (in foot-Lambert-msecs).

The data samples S0,S1,S2,...,Sn are stored in the file for the low-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>
state, and have been scaled up by a factor of 9 as a result of application
of a 3x3 low-pass <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> (used to suppress shot noise).  The dark-current
is subtracted from these data samples before insertion into the file.
(See the documentation of VICAR program MJSPFCF for details).

The first record of the radiometric file contains the number of data points
in the file (n), and luminance values L0,L1,L2,...,Ln corresponding to
exposures E0,E1,E2,...,En for a reference shutter speed of 1 second.
The remaining records contain the data samples Si for each pixel.  Each
ordered pair (Li,Si) comprises a data point on the light-transfer curve which
characterizes that pixel's response to exposure to a light source.

OPERATION:

"ficor77" assumes that the first input file is the image to be radiometrically
corrected (PIC).  Upon entry, "ficor77" extracts the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> ID (serial number),
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> position, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>-state, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate, and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> from the input picture
label.  (These values may be overridden via optional parameters <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">CAMERA</A>,
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">FILTER</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">GAIN</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">SCAN</A>, and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">MODE</A>.)

The remaining inputs are a list of radiometric and dark-current files, which
may appear in any order.  The program automatically selects the correct
radiometric file and dark-current frame by scanning this list for a radiometric
file with matching <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> ID and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A>, and a dark-current frame with matching
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> ID and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate, as indicated in the picture labels for these files.
(The <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> ID, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>-state, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate, and operating <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> obtained from the
dark-current picture label may be overridden via optional parameters <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dccam">DCCAM</A>, 
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcgain">DCGAIN</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcscan">DCSCAN</A>, and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcmode">DCMODE</A>.)

For each pixel of the input image, the radiometric correction process
consists of the following steps:

  1) The DN values D and DC for the pixel are extracted from the input
     image and dark-current frame respectively.  If the input image
     (or dark-current) was taken in high-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>, the DN value is converted
     to equivalent low-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A> DN by dividing by the gain ratio (see GAIN
     parameter).  The pixels are also scaled by 9 (see <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#div">DIV</A> parameter) to
     match the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> of the samples in the radiometric file.  If the
     input dark-current frame represents a sum of multiple dark-currents,
     the dark-current DNs are scaled by dividing by the number of frames
     summed together (see <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#numdc">NUMDC</A> parameter).

  2) The dark current is removed:  S = D - DC

  3) The resulting signal (S) is converted to luminance:  A piece-wise
     linear model of the light-transfer function is used, such that each
     data point (Li,Si) is assumed to lie on the curve, and the curve is
     assumed to be linear between data points.  Let
		S  &lt S < S
		 i        i+1
     The signal is converted to luminance by interpolating between the
     data points:

		    L    - L 
		     i+1    i
		L = -----------(S - S ) + L
		    S    - S         i     i
	             i+1    i

     where L is in units of foot-Lamberts.

  4) The output pixel is scaled to radiometric units R (Ref. 4).  The
     user determines the output picture <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> by specifying one of the
     following (see <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#conv">CONV</A> parameters.):

	A1 = number of 'I over F' units per DN, where 10,000 I/F units
             would be produced by normal incidence of sunlight on a 
	     a Lambert disk at the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A>'s distance from the sun.

 	A2 = number of nanowatts per cm**2 per steradian per nanometer
             wavelength per DN.

     If A1 is specified, then

		        to     S1	
		R = L * --- * ---- * (D/5.2)**2
			 t     A1
     where

	to = reference shutter speed of the data points (msec),
	t  = shutter speed of the input image (msec).
	S1 = <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A>-dependent conversion factor from ft-Lamberts to
	     I/F units for a reference distance of 5.2 AU from the Sun.
	D  = <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A> distance from the Sun (in AU).  D is 5.2 AU for Jupiter,
	     9.51 AU for Saturn, 19.122 AU for Uranus, 30.21 AU for Neptune.

     For Voyager 2, the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A>-of-encounter is determined by searching the
     frame label for a valid PICNO, Spacecraft-Event-Time (SCET), or Earth-
     Received-Time (ERT), in that order.  This may be overridden via the
     <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">PLANET</A> keyword.

     For Voyager 1, the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A>-of-encounter is always set to Jupiter, and this
     may not be overridden.

     NOTE: Prior to March 1988, the correction for solar distance (D/5.2)**2
     was not applied, and all frames were scaled to Jupiter's distance from
     the sun.  The program "fixvgr" was used to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> the frames to Saturn or
     Uranus, and to correct for errors in the ground calibration values of
     S1 (see below).

     If A2 is specified, then

			 S2
		R = L * ----
			 A2

     where S2 is the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A>-dependent conversion factor from ft-Lamberts
     to units of nanowatts/cm**2/steradian/nanometer.

     For images taken during ground calibration, the keyword <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#lc">LC</A> should be
     used to specify Xenon light-cannon (rather than solar) illumination.
     Values for S2 are retrieved from tables stored in the program for
     each <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A>-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> combination for both solar and light-cannon
     illumination.

  5) The output DN is converted to the specified data format.  For byte
     output, the DN range is ALWAYS 0 to 255.  Values outside this range are
     truncated to 0 or 255, as appropriate.   For halfword (16-bit integer)
     and real output, the default range is -32768 to +32767 (i.e. the full
     halfword range).  Although a negative DN value has no physical meaning,
     this may occur if the dark-current frame has a higher dark-current
     level than that of the input image.  Negative DNs may be set equal
     to zero via the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#noneg">NONEG</A> keyword.  The upper limit may be modified
     via the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#maxdn">MAXDN</A> parameter.

OUTPUT <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">SCALE</A> CORRECTION:

As of March 1988, the output DN <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> is corrected using factors derived
from analysis of calibration plaque data (see Ref. 4) and comparisons with
ground-based data (see Ref. 5).  This <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction may be suppressed
via the NOCORRECT parameter.

The following <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction is applied to each pixel:

			R' = S*R

where the constant S is a function of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> position.
S is retrieved from a table stored in the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">Scale</A> Correction File (<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scf">SCF</A>).
This file may be specified by the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scf">SCF</A> parameter.  (Note: The constants
in the file have the target-to-Sun distance correction built into them).

The <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction is identical to the correction applied by program
"fixvgr", except that "fixvgr" rescales the output DN values to 1 '<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A>' unit
per DN.  Images which have been <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A>-corrected by "ficor77" need not be
processed by "fixvgr".  If processed by "fixvgr", no re-scaling is done unless
the constant has been changed.  Images <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A>-corrected by "ficor77" may be
identified by the following picture label:

  (e.g) COMMENT=' PICTURE MULTIPLIED BY  0.93   FICOR	2/02/86 VERSION'
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">SCALE</A>='URANUS'

where 0.93 is the constant S, URANUS is the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A>-of-encounter, and
2/02/86 is the version date of the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scf">SCF</A>.  See the help file for program
"ficorgen" for source documentation of the current and past <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction
values.

PARAMETERS:

All user parameters are optional, and are entered in one of the following
forms:
		KEYWORD=string
		KEYWORD=n
		KEYWORD=r
		'KEYWORD
where 'string' is an ASCII character string, 'n' is an integer value and
'r' a real value.  The following is a summary of the parameters.  Use the
TUTOR <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> for a more complete description.

	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">CAMERA</A> STATE PARAMETERS
	-----------------------
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#expo">EXPO</A>=r		- Override input image exposure time (msec)
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">FILTER</A>=n        - Override input image filter position (-1&ltn<8)
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">GAIN</A>=n		- Override input image gain (N=0 low, N=1 high)
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">MODE</A>=n		- Override input image mode (1-7)
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">SCAN</A>=n		- Override input image scan rate
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">CAMERA</A>=n	- Override input image camera serial number

	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcgain">DCGAIN</A>=n	- Override dark current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcmode">DCMODE</A>=n	- Override dark current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A>
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcscan">DCSCAN</A>=n	- Override dark current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A> rate
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dccam">DCCAM</A>=n		- Override dark current image <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> serial no.

	'<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#nocheck">NOCHECK</A>	- Bypass matching of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> parameters; the calibration
			  file must be the second input and the dark-current
			  must be the third input.
        '<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filteq">FILTEQ</A>         - Equate NA <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> indices 0 with 4 (CLEAR), 
                          and 5 with 6 (GREEN)

	OUTPUT IMAGE <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">SCALE</A>
	------------------
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#conv">CONV</A>=r		- Number of nanowatts per cm*2 per steradian per
			  nanometer wavelength per output DN.
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A>=r		- Number of "I over F " units per output DN.
        SCL=string	- <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">Scale</A> Correction File
	'<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">planet</A>		- where planet is JUPITER, SATURN, URANUS, or NEPTUNE.
	'NOCORRECT	- Suppress FIXVGR <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction

	DATA FORMAT KEYWORDS
	--------------------
	'BYTE		- Output image in byte format
	'HALF		- Output image in halfword format
	'REAL		- Output image in floating point format
	'<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#noneg">NONEG</A>		- Set all negative output DN to zero
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#maxdn">MAXDN</A>=n 	- Maximum DN in the output image
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#numdc">NUMDC</A>=n		- Number of dark-current frames summed together

	MISCELLANEOUS
	-------------
	'<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dbug">DBUG</A>		- Some diagnostics output
	'<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#lc">LC</A>		- Input image taken under light-cannon illumination
	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#div">DIV</A>=r		- Calibration file <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> factor

<A NAME="examples">EXAMPLES:</A>

"ficor77" is most commonly used as follows:

	ficor77 (PIC,CAL,DC) OPIC <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">GAIN</A>=0

The calibration file (CAL) must be for the same <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> as PIC.
The dark-current file (DC) must be for the same <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate.
The output frame (OPIC) will be in halfword (16-bit integer) format.

The value of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A> is chosen to maximize use of the output 16-bit DN range
(0-32767).  The default value for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A> (IOF=1) is appropriate for most
targets.  For targets of low albedo (e.g. Saturn's rings), <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A> is chosen
within the range  0.01 &lt <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof">IOF</A> < 1.0.

Most of the remaining parameters are used to work around occasional errors
in picture label information.  Since high-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A> images were acquired for
only a small percentage of VGR-1 Jupiter frames, the parameter <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">GAIN</A>=0 is
regularly used to override the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>-state value to low-gain.

ERROR MESSAGES:

All error messages are preceded by three asterisks (***).  An error is fatal
only if it is immediateley followed by the message:
		"***FICOR task cancelled"

TIMING:

"ficor77" requires 21 CPU seconds on the VAX 8600.  It will complete within
30 seconds (wall-clock) on a single-user system and about 3 minutes on a
system supporting 20 users.  The program reports its progress by printing
the line count at 100-line intervals.

REFERENCES:

1) JPL Technical Memorandum 33-628 "A User's Guide to the Mariner 9
   Television Reduced Data Record", 1973.

2) JPL Document 618-802 "Voyager Imaging Science Subsytem Calibration
   Report", M. Benesh and P. Jepsen, 31 July 1978.

3) P. Jepsen, et.al., "Voyager Image Processing at the Image Processing
   Laboratory", Journal of the British Interplanetary Society, Vol. 33,
   pp 315-322, 1980.

4) G.E.Danielson, et.al., "Radiometric Performance of the Voyager Cameras",
   JGR Vol 86, NO.A10, pp 8683-8689, 30 Sep 1981.

5) T.V. Johnson, "Corrections to Danielson et.al. Calibration", memorandum
   to the Voyager Imaging Team, 16 Jan 1986.

PROGRAM HISTORY:

Written by: Joel A. Mosher	Jan 78
UCL Implementors: M.L. Kendall & R.F.T. BARREY	Jan 82
<A NAME="CogProg">Cognizant programmer: Gary Yagi</A>
Revisions:
  1985-10-01 FFM - Change to VICAR2 I/O and convert subroutine
	           LCOR from fortran to assembler
  1988-02-01 GMY - Major code clean-up and enhancements:
		     0) Rewrite help file.
		     1) Add FIXVGR <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A> correction factors.
		     2) Delete redundant keywords SN,FP,HSAT,SUN
		     3) Delete null keyword FICOR
		     4) Fix OUTREAL keyword
		     5) Fix bug reading last Cal-File record.
		     6) Modified processing of negative DN (LCOR)
		     7) Delete FORMAT keyword
		     8) Fix bug in processing high-<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A> pictures
		     9) Accept input of summed dark-current frames.
  1988-02-25 GMY - Fix <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">SCAN</A>=10, bad <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> (FR 33244)
  1988-06-07 GMY - Fix processing of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#expo">EXPO</A> keyword.
  1988-12-21 GMY - Fix processing of parameters passed via procedures.
  1992-05-24 GMY - Update test script (FR 64507)
  1993-07-09 GMY - Check for input image with zero exposure (FR 79136)
  1994-10-31 AMS - (CRI) Made portable for UNIX
  1998-11-09 GMY - Updated test script to point to where test files are.
  1999-05-24 GMY - Corrected problem with negative and 0 DNs.
  2014-07-21 WLB - Initialized <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> variables MODE and MODEDC to
                   get consistent results between linux and sun.
  2015-09-03 WLB - Replaced calls to entries with calls to subroutines.
  2020-04-02 WLB - IDS-8166 - Added '<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filteq">FILTEQ</A> parm.
                   Remaining warning at ficor77.f:96.36:
                     CALL OPSCALE(ICAM,IFILT,IPLAN,ISPEED,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#maxdn">MAXDN</A>,NC,IBUG,
                                                   1
                     Warning: Type mismatch in argument 'speed' at (1); passed INTEGER(4) to REAL(4)

RESTRICTIONS:

The vgrscf.dat input file is generated on the MIPLs only.
See "fixvgr" for more information.

</pre>
<hr>
<H2>PARAMETERS:</H2>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#inp"><H3>INP</H3></A>
3 to 10 files: Input image,
radiometric file(s), and
dark-current frame(s).
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#out"><H3>OUT</H3></A>
Output corrected image
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#size"><H3>SIZE</H3></A>
4 integers--optional
Standard Vicar <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#size">size</A> field 
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#sl"><H3>SL</H3></A>
Integer--optional
Starting line
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#ss"><H3>SS</H3></A>
Integer--optional
Starting sample
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#nl"><H3>NL</H3></A>
Integer--optional
Number of Lines
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#ns"><H3>NS</H3></A>
Integer--optional
Number of Samples
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera"><H3>CAMERA</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">Camera</A> serial number
(4,5,7, or 8)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter"><H3>FILTER</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">Filter</A> position (0 to 7)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain"><H3>GAIN</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">Gain</A> state (Low=0,High=1) 
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan"><H3>SCAN</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">Scan</A> rate (1 to 10)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode"><H3>MODE</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">Camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A> (1 to 7)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#expo"><H3>EXPO</H3></A>
Real--optional
Exposure time (msec)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dccam"><H3>DCCAM</H3></A>
Integer--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">Camera</A> serial number 
of dark-current file
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcgain"><H3>DCGAIN</H3></A>
Integer--optional
Dark-current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#gain">gain</A>-state
(Low=0,High=1)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcscan"><H3>DCSCAN</H3></A>
Integer--optional
Dark-current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scan">scan</A>-rate
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#dcmode"><H3>DCMODE</H3></A>
Integer--optional
Dark-current <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#mode">mode</A>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#numdc"><H3>NUMDC</H3></A>
Integer--optional
Number of dark-current
frames summed together
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#iof"><H3>IOF</H3></A>
Real--optional
I over F units per DN 
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#conv"><H3>CONV</H3></A>
Real--optional
Number of nanowatts per
cm**2 per steradian per
nanometer wavelength per DN 
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet"><H3>PLANET</H3></A>
Keyword--optional
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#planet">Planet</A>-of-encounter
Valid values are:
Jupiter, Saturn,
Uranus, or Neptune.
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#oformat"><H3>OFORMAT</H3></A>
KEYWORD--OPTIONAL
Output image data format
Valid: BYTE,HALF,REAL
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#maxdn"><H3>MAXDN</H3></A>
INTEGER--OPTIONAL
Maximum DN for output
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#nocheck"><H3>NOCHECK</H3></A>
KEYWORD--OPTIONAL
Suppresses matching
of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> parameters
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filteq"><H3>FILTEQ</H3></A>
KEYWORD--OPTIONAL
Equates NA <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#camera">camera</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A> indices
0 with 4 (CLEAR), and 5 with 6 (GREEN)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#noneg"><H3>NONEG</H3></A>
KEYWORD--OPTIONAL
Negative dn's set to zero
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#lc"><H3>LC</H3></A>
KEYWORD--OPTIONAL
Specifies xenon light-cannon
illumination
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#div"><H3>DIV</H3></A>
REAL--OPTIONAL
Number of pixels in
low pass <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#filter">filter</A>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#nocorrec"><H3>NOCORREC</H3></A>
KEYWORD--OPTIONAL
Do not correct <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">scale</A>.
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scf"><H3>SCF</H3></A>
STRING--OPTIONAL
<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale">Scale</A> Correction File.
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77_level2.html#scale"><H3>SCALE</H3></A>
(Not implemented)
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77.html#examples"><H4>See Examples:</H4></A>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/ficor77.html#CogProg"><H4>Cognizant Programmer:</H4></A>
</BODY>
</HTML>
