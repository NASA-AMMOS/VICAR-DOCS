<HTML>
<HEAD><title>HTML Help for STARCAT3</title></HEAD>
<BODY>
<H1>Help for STARCAT3</H1>
<pre>
PURPOSE
  STARCAT3 is a VICAR*2 applications program which locates and integrates
  features consisting of contiguous pixels above a given threshold in 
  an image and places the results into a catalog file.


OPERATION

  STARCAT3 locates and associates all contiguous pixels above a user
  specified threshold into single <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>.
  
  STARCAT3 uses the first moment of the marginal distribution with a static
  threshold to detect <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>. The marginal distribution is the algorthim
  described in Auer and Altena (Reference 1) with the modification described
  by Stone (Reference 2).


DATA FILES

  The input image is a starfield. It may be from any type of sensor such
  as a CCD, vidicon, or digitized photogrpahic plate or film..
  Valid formats are BYTE, HALF and FULL.

  The primary output is a 21 column IBIS-2 tabular file catalog described 
  in detail below. This catalog format is not compatible with the
  catalogs produced by STARCAT and STARCAT2. Those catalogs were based
  on a non-transportable format to UNIX systems (because it equivalenced
  real and integer variables). The catalog produced by STARCAT and STARCAT2
  is described below for illustrative purposes.
  
  An optional second output data set can be produced where located
  features are highlighted. This data set will have the same dimensions
  as the original data set but will always be of BYTE data type. The data
  set will have only two values, 0 and 255, where detected features are
  at DN=255 (white) with all data below the threshhold as DN=0 (black).
  
  An optional third output is a halfword data set having the object numbers
  found on each line as they are found before rejection criteria are applied
  This is the so-called the flag buffer output.


PROGRAM PARAMETERS

  Parameters are provided to manage program flow and to provide object 
  rejection criteria. The use of the rejection parameters can be highly
  subjective and depends heavily on the scene content. For this reason
  the second and third output files provide the user a visual examination
  of the effectiveness of STARCAT3.

  STARCAT3 is normally used to detect stars in an astronomical observation.
  The sensors used have been vidicons, CCDs and digitized photographic 
  negatives. Vidicon and CCD data sets are normally radiometrically 
  corrected before using STARCAT3 by subtracting darks, biases and dividing
  by flat fields.

  Optimal results requires the image to have as flat a background in the data
  set as possible since only one threshhold value is allowed for STARCAT3 --
  You do not want detect <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> which are really only do to subtle variations
  in the background noise.

  Alternatively, should the user have no dark file, flatfield to correct
  the data, the user can subtract a constant background value with the
  parameter <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A>. BACK is a value corresponding to the median dn value
  of the histogram of the image. <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A> is important for the summation of the
  dn values within the object to make magnitude estimations.

  Photographic negatives which have been digitized for this operation
  typically do not have background data sets. If you have a
  particularly noisy, grainy or spotty photographic negative, the
  user can generate a pseudo background by one of two methods: 
  1) Run VICAR program MEDIAN on the original data set with a very large
  kernel - something on the order of 300 x 300 which will remove high
  frequency data (the stars) or with a kernel 4 to 5 times the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> of the
  largest real object. Then subtract the pseudo background from the
  orginal data (either with F2 or by inlcuding it as the 2nd input data set).
  VICAR program MEDIAN is not too swift since it is a sorting algorithm
  and can take many minutes to run on a large (2K x 2K is large in this sense)
  data set.
  2) Run VICAR program <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">SIZE</A> with the interpolate option on the original
  data down to between 4 to 64 times smaller than the original data set and
  and then expand the data set with program <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">SIZE</A> <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">back</A> up to its original size
  with the interpolate option.

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A> PARAMETER

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A> specifies the true zero intensity level in DNs of the input image.
  It is usually the median value of the histogram of the corrected image data. 
  VICAR programs HIST or ORDSTAT provides the mean
  as a returnable parameter in a PDF. Note that HIST returns the mean as
  a real variable and ORDSTAT returns it as an integer. Since starcat3
  expects integer values for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A> then if HIST is used to provide an input
  to STARCAT3 it should be converted float to integer within the pdf.

  Object intensities are computed after background subtraction as:

  			I=SUM(DN    -<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A>)
                   ij    INij

  Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A>=0.

  PARAMETERS <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre">THRE</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens">SENS</A>

  The selection of a good threshold is the key to successful STARCAT3
  execution. If you only wish to see the brightest <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> then the
  threshold can be somewhat arbitrary, but if you wish to detect fainter
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> then care must be taken and it becomes more and more important
  to have a flattened background.

  Internally the program sets this value to be the lowest value allowed
  by the data set format, 0 for BYTE, -32768 for HALF, and -2,147,483,547
  for FULL data sets. Thus, it will find 1 large object (the entire data
  set) if no value is entered.

  A good place to start is some multiple of the standard deviation from
  the histogram of the image. A reasonable value to start with is about
  3 sigma above the mean.

  Alternatively, the user can display the image and select a DN value
  that lies somewhat above background and start from there.

  If KEYWORD "<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A>" is specified then the program computes a local
  threshold based upon the average DN in the image plus the standard 
  deviation (sigma).  The sensitivity factor, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens">SENS</A>, is the number of
  sigma to multiply by according to the equation 

	autothreshold = mean + sensitivity*std_deviation

  If you start with the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A> option then choose <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens">SENS</A>=3.0. Default is 1.0
  though.


  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> PARAMETER

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> is the saturation value in the image. By default in STARCAT3
  a BYTE input data, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> is set to 255, a HALF data set it is set to 32767
  and a FULL data set it is to 2,147,483,647. However, not all sensors
  have dynamic ranges this high for a given data format. <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> gives the
  user the ability to set the correct saturation value for the sensor.

  Internally <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> is the highest value that STARCAT3 will accept for a
  valid object. Note that <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> (below) indicates that if a pixel of SPIKE
  or higher is detected within an object boundary then that object is to be
  ignored in generating the starcat catalog.  Internally STARCAT3 sets a
  value for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> to be 1 DN above the saturation value unless the saturation
  value is the highest integer value for the data type. For example, if the
  image format is 'BYTE' and the saturation value. <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>, is 255 then any
  value entered for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> will be ignored.

  The same thing holds true if the data format is 'HALF' and the saturation
  value is 32767 or if the data format is 'FULL' and the saturation value
  is 65535. However, if the user enters a <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> value less than the highest
  value for the data format and less than the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> value then
  the program will reset the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A> value to 1 less than the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> value.
  (It assumes that the value the user gives for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> is correct).

  The check for saturation is applied before background subtraction
  since saturation is independent of background.

  STARCAT3 will report the number of pixels within an object that have 
  reached the saturated value in column 21. 

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> AND <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#loval">LOVAL</A> PARAMETERS (OBJECT REJECTION CRITERIA)

  These two values are not exactly complementary as are the four pairs
  below. So read and understand the following.

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> is the value which, if a DN value is detected which is greater or
  equal to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> is found within the boundary of an object, it will cause
  the object to be rejected as a valid object. Note the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> value
  comparison is applied before background subtraction. 

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#loval">LOVAL</A> is the value which, if a DN value is detected which is lower than
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#loval">LOVAL</A> within the boundary of an object, it will cause the DN value to be
  replaced by <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre">THRE</A> in the summation of the DNs within the object. This will
  prevent an artificially low DN value (such as a bad pixel value) from being
  subtracted from the value to be stored in column 2 of the catalog.


  OBJECT REJECTION CRITERIA
  
  The other parameters associated with the rejection of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> are
  complementary:
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mini">MINI</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi">MAXI</A> - Intensities of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>, minimum and maximum
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minp">MINP</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxp">MAXP</A> - Number of Pixels (Area), minimum and maximum
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minl">MINL</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxl">MAXL</A> - Number of Lines of object, minimum and maximum
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mins">MINS</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxs">MAXS</A> - Number of Samples of object, minimum and maximum

  If the value is greater than the maximum the object is rejected. If the
  value is less than the minimum the object is also rejected.
 
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#list">LIST</A> PARAMETER

  The optional KEYWORD "<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#list">LIST</A>" allows the catalog to be printed to
  the screen or session log as the catalog is being created.
  LIST1 prints other messages to screen. NOLIST prints no messages.

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">OBJECTS</A> PARAMETER
 
  The program will return the number of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> found in this parameter


  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A> PARAMETERS

  The KEYWORD "<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A>" causes the following 6 keywords to be activated:
  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saominp">SAOMINP</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astminp">ASTMINP</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saoratio">SAORATIO</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astratio">ASTRATIO</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxw">ASTMAXW</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxl">ASTMAXL</A>

  The <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A> parameter was designed for streak detection on old Palomar
  48-inch plates. Those plates were exposed long enough such that asteroids
  would show up as long streaks and these parameters allow automated tentative
  identification.  When the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A> option is activated the catalog will
  add "<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">asteroid</A>" or "star" in column 20 (classification) and "starcat3"
  for column 14 (catalog).

ALGORITHM

  <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">Objects</A> are associated together by maintaining a flag buffer (one line) 
  which contains zeroes except where 'an above threshold event' has occured.
  Event pixels are set to a unique ID value or flag. Internally the program
  allows up to 2000 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> to be active for two lines. This value is
  maxobjs and is a parameter in subrouine centfind. When the next image
  line is processed and a section through an object is located, each
  pixel in that section is compared with the three closest values in
  the flag buffer for the preceeding line. If the flag has been set
  to a non-zero ID, that ID is propagated downward and the object
  section is integrated in with that ID. If the section spans more
  than an ID, the IDs are concatenated. Sections which have no
  flagged values in the preceeding line are considered new <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>
  and flagged values which are not propagated downwards are considered
  complete. Catalog entries are made only after an object is completed.
  Parameters are provided to restrict the areas, intensities, and 
  dimensions of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> which are placed into the catalog. 


STARCAT CATALOG
  
  Information about each object is entered into a catalog which
  contains 21 descriptors for each entry. Each entry is stored in the
  order as they were completed. The catalog is organized  as follows:


  The starcat catalog is an IBIS-2 tabular file which has the following format.


	***************************************************************
    	descriptor	description		        format		    units
	    ----------	-----------		        ------		    -----
     1	entry		catalog entry number	 full(1)		&ltnone&gt		
     2	DN-bkg  	sum of DNs - background	 real(1)		counts
     3	sumpix  	number of pixels 	     full(2)		&ltnone&gt
     4	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl">sl</A>      	starting line		     full(3)		&ltnone&gt
     5	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss">ss</A>		    starting sample          full(4)		&ltnone&gt
     6	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#nl">nl</A>		    number of lines		     full(5)		&ltnone&gt
     7	<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ns">ns</A>		    number of samples        full(6)		&ltnone&gt
     8	centsamp	centroid sample          real(2)		&ltnone&gt
     9	centline	centroid line            real(3)		&ltnone&gt
    10	maj axis	major axis length        real(4)		&ltnone&gt
    11	min axis	minor axis length        real(5)		&ltnone&gt
    12	ratio     	ratio minor/major axis	 real(6)		&ltnone&gt
    13	rotangle  	rotation angle of ellip	 real(7)		degrees
    14	catalog   	source catalog           ascii(1)-'A16'	&ltnone&gt
    15	ID		    catalog ID               ascii(2)-'A20'	&ltnone&gt
    16	RA		    right ascension          real(8)		hours
    17	dec		    declination              real(9)		degrees
    18	mag calc	calculated magnitude     real(10)      	&ltnone&gt
    19	mag ref   	catalog magnitude        real(11)      	&ltnone&gt
    20	class     	classification           ascii(3)-'A8'	&ltnone&gt
    21  satpix    	number of saturated pix  full(7)       	&ltnone&gt
	***************************************************************

  Prior to Jan 21, 1995, STARCAT3 produced STARCAT catalogs of TYPE 1
  which had only the first 20 columns. However, the addition of column
  21 allows better analysis of starfield for use in other VICAR Astometry
  and photometry programs.
  

  STARCAT3 fills in columns 1 to 13 and 21 for each object it detects.
  If the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A> parameter is active it will fill in columns 14 and 20.
  Column 14 (catalog) will contain "starcat3" and column 20 (class)
  will contain either "<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">asteroid</A>" or "star".
 
    Prior to Oct 6, 2009 the catalog stored <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl">sl</A>, <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss">ss</A>, centline, centsamp
    with respect to the window if the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> or <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl">sl</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss">ss</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#nl">nl</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ns">ns</A> parmeters were
    used. This can cause problems with further uses of the starcat catalog
    that is produced since most users want the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> in the original\
    image.  Now if you want the catalog to refer to a window, then
    you should extract the smaller image <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out">out</A> of the larger and then
    run starcat3.

OLDER STARCAT and STARCAT2 catalogs

  The format of the catalogs created by STARCAT and STARCAT2 are as follows:
  One record is 48 bytes. These programs use an unportable equivalencing
  of fortran real*4 and integer*4 data types.

  WORD #  CONTENTS        	TYPE	COMMENTS

    1     SUM of DN - BKG      I*4  represents total intensity of object
    2     SUM pixels      	I*4	area covered by object
    3     <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl">SL</A> area         	I*4	with respect to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> field
    4     <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss">SS</A> area         	I*4	with respect to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> field
    5     <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#nl">NL</A> area         	I*4	with respect to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> field
    6     <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ns">NS</A> area         	I*4	with respect to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> field
    7     Centroid sample 	R*4	center of object in sample
    8     Centroid line   	R*4	center of object in line
    9     major axis length  	R*4	major axis length - right ascension
   10     minor axis length  	R*4	minor axis length - declination
   11     Used for <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A>     R*4     1.0= SAO star, 2.0= asteroid
   12     rotation angle	R*4	about major axis, degrees

There is no program to interconvert the catalogs at this time.

LIMITATIONS:

  1. Maximum of 2000 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> for the flag buffer.
  2. Input data files are limited to BYTE, HALF and FULL


TIMIMG
   Exact timings are not yet available for the VAX: IBM time
   for a 1300 x 1300 image with 400 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> was 40 seconds.


REFERENCES

  1. L.H. Auer and W.F. van Altena, The Astronomical Journal, Vol83, 531 (1978)
  2. Ronald C. Stone, The Astronomical Journal, Vol 97, 1227 (1989)


ERROR MESSAGES

??E XVunit error on 1st input file
??E XVopen error on 1st input file
??E XVopen error on output catalog file
??E XVunit error on 2nd output image
??E XVopen error on 2nd output image
??E XVunit error on 3rd output image
??E XVopen error on 3rd output image

1) ??E Format XXXXXX not supported by STARCAT3
	- program does not support REAL, DOUB or COMP images

2) ??E **SUBROUTINE FIND - All 2000 bins filled
	- exceeded maximum number of <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> per line (2000) - the only
	  way to change this limit is to change parameter maxobjs in the
	  main routine, recompile and relink the program..

3) ??E **SUBROUTINE AUTOT -  All values zero in minimum search

4) Catalog of type ',a16,' not starcat catalog
	- Cannot be fixed

PROGRAM HISTORY:

  1977-09-12 J.J.LORRE   Initial release
  1978-01-17 J.J.LORRE   Revisions and documentation
  1978-11-10 J.J.LORRE   Accomodate VICAR-77 label
  1982-08-23 R.D.TOAZ    Increased efficiency of dupe rejection
  1982-10-13 J.J.LORRE   New keywords: <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxp">MAXP</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mini">MINI</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi">MAXI</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minl">MINL</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxl">MAXL</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxs">MAXS</A>,LINE,OVER,UNDER
  1984-08-23 M.E.MORRILL Conversion to VAX VICAR*1
  1984-09-25 M.E.MORRILL Conversion to VAX VICAR*2
  1985-02-06 M.E.MORRILL Now extracts VICAR1 and VICAR2 labels
  1988-07-01 J.J.LORRE   Added 4 fields into catalog: major,minor,angle values.
                         Background file.
  1990-08-15 R.J.BAMBERY Add <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens">SENS</A> parameters	
  1992-12-28 R.J.BAMBERY Modified to run under UNIX
  1993-02-09 R.J.Bambery Fixed bug that didn't give correct <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#nl">NL</A> to catalog
  1994-01-31 R.J.Bambery Made portable using new IBIS-2 format for catalog
  1994-03-28 R.J.Bambery Completed port
  1994-07-05 R.J.Bambery Fixed bug in output byte file from half files for rmindn
  1994-08-26 R.J.Bambery Added ability to process FULL data sets
  1994-11-02 R.J.Bambery No longer outlines <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> in output image. Makes detected
                         <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> white on black bkg
  1994-12-19 R.J.Bambery remove error messages on UNIX systems
  1995-01-05 R.J.Bambery parameterize maxobjs and set nbin to 2000
  1995-01-21 R.J.Bambery Changed catalogs to TYPE 2 by adding column 21 (# of 
                         saturated pixels). Improved flow by better defining <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>, 
                         <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mini">MINI</A> & <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi">MAXI</A>
  1995-02-06 R.J.Bambery Added <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#loval">LOVAL</A> parameters - changed PRINT to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#list">LIST</A> to 
                         conform to other programs in this series
  1995-02-22 R.J.Bambery Removed optional background data set as second input -- it 
                         caused too many coding problems
  1996-02-20 R.J.Bambery Added <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">OBJECTS</A> return value
  2004-09-05 R.J.Bambery Added LIST1 parameter to <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#list">LIST</A>`
  2009-10-06 R.J.Bambery got rid of old xvparm calls (changed to xvp) added extra 
                         parameters to chkstat calls, redefined output <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl">sl</A> and <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss">ss</A> to 
                         be with respect to full image when only windowing with <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> 
                         into the image
  2009-10-17 R.J.Bambery Fix catalog windowing offset error (offset - 1)
  2010-01-30 R.J.Bambery Made compatible with 64-bit afids Build 793 Linux, MacOSX 
                         (both Intel/PowerPC)
  2011-06-20 R.J.Bambery Removed all warning messages generated from gcc 4.4.4 Build 
                         1069. Removed variables from several misaligned subroutince 
                         calls
  2012-06-06 R.J.Bambery Removed unnecessary parameters in calls, fixed
                         misaligned arrays, changed all dimension (1)
                         values to (*) in subroutines to avoid
                         "Fortran runtime error: Index '2' of dimension 1 of array 'id' 
                         above upper bound of 1" in gfortran 4.6.3
  2012-06-25 R.J.Bambery Change include 'errdefs.fin' to include 'errdefs'
  2012-07-03 R.J.Bambery Removed &lttab&gt in front of continuation
                         lines to make backward compatible with
                         32-bit Linux gfortran 4.2.1, otherwise
                         compatible 64-bit Linux gfortran 4.6.3
  2013-09-13 R.J.Bambery Removed last vestiges of debug statements
  2013-09-15 R.J.Bambery Initialized arrays for ibis output. Found call mve
                         is a problem for double arrays (call mve(8,nbin,0,cenx,0,1)) fails
  2016-03-07 W.L.Bunch   Added ithr rounding; changed <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi">MAXI</A> default from 4.0E9 to 1.0E38 to 
                         better allow for saturation in fullword images (from SP circa 1997).
                         Replaced xqout with xvqout for shell vicar's benefit.
                         Migrated to mipl.

EXECUTION:
  
  starcat3 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#inp">INP</A>=SP.IMG <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out">OUT</A>=SP.CAT PARAMS

  starcat3 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#inp">INP</A>=SP.IMG <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out">OUT</A>=(SP.CAT,SP.OUT) PARAMS

  starcat3 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#inp">INP</A>=SP.IMG <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out">OUT</A>=(SP.CAT,SP.OUT,SP.FLAG) PARAMS

  starcat3 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#inp">INP</A>=SP.IMG <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out">OUT</A>=(SP.CAT,SP.OUT,SP.FLAG) PARAMS

Parameters are defined in the TUTOR mode. <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">SIZE</A> is optional and
can be used to restrict the search area in the input image within
which <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> are to be located.


</pre>
<hr>
<H2>PARAMETERS:</H2>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#inp"><H3>INP</H3></A>
 An input image.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#out"><H3>OUT</H3></A>
 Output 1 = CATALOG
 Output 2 = BYTE image of
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> equal to the input
 (all <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> set to DN=255).
 Output 3 = "flag" image
 SEE HELP FOR CAT FORMAT.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size"><H3>SIZE</H3></A>
 The standard Vicar <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#size">size</A> field.
 Restricts the search area

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sl"><H3>SL</H3></A>
 Starting line of search area

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ss"><H3>SS</H3></A>
 Starting sample of search area

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#nl"><H3>NL</H3></A>
 Number of lines in search area

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#ns"><H3>NS</H3></A>
 Number of samples in search area

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#list"><H3>LIST</H3></A>
 KEYWORD-OPTIONAL
 Print catalog to session
 log/terminal. LIST1 prints
 minimal other messages

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back"><H3>BACK</H3></A>
 INTEGER-OPTIONAL
 Background DN level. 
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#back">BACK</A>=0.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd"><H3>MAXD</H3></A>
 INTEGER-OPTIONAL
 Maximum DN for an object
 (Saturation)
 Defaults:
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>=255 for BYTE images
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>=32767 for BYTE images
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>=2147483647 for FULL images

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike"><H3>SPIKE</H3></A>
 INTEGER-OPTIONAL
 Reject object if DN value
 greater or equal to
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#spike">SPIKE</A> found in object

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#loval"><H3>LOVAL</H3></A>
 INTEGER-OPTIONAL
 If this DN value found in
 object replace it with 
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre">THRE</A> value.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto"><H3>AUTO</H3></A>
 KEYWORD-OPTIONAL
 Compute a global threshold for
 the <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>
 If <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A>=AUTO then <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre">THRE</A> is
 ignored.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens"><H3>SENS</H3></A>
 REAL-OPTIONAL
 Number of sigma to add to the
 autothreshold if <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A>=AUTO
 Ignored if <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#auto">AUTO</A>=NOAUTO
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#sens">SENS</A>=1.0

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre"><H3>THRE</H3></A>
 INTEGER-OPTIONAL
 Threshold DN for real <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A>.
 Lowest value in image format
 After background subtraction
 Default: <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#thre">THRE</A>=--

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mini"><H3>MINI</H3></A>
 REAL-OPTIONAL
 Ignore <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> whose sums of 
 DNs are less than this value
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mini">MINI</A>=-2,147,483,648

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi"><H3>MAXI</H3></A>
 REAL-OPTIONAL
 Ignore <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> whose sums of
 DNs are greater than this
 value.
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxi">MAXI</A>=<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxd">MAXD</A>+1

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minp"><H3>MINP</H3></A>
 INTEGER-OPTIONAL
 Object minimum area in pixels.
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minp">MINP</A>=4.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxp"><H3>MAXP</H3></A>
 INTEGER-OPTIONAL
 Object maximum area in pixels.
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxp">MAXP</A>=Infinity.
 (+2,147,483,647)

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minl"><H3>MINL</H3></A>
 INTEGER-OPTIONAL
 Minimum lines in object.
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#minl">MINL</A>=2.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mins"><H3>MINS</H3></A>
 INTEGER-OPTIONAL
 Minimum samples in object
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#mins">MINS</A>=2.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxl"><H3>MAXL</H3></A>
 INTEGER-OPTIONAL
 Maximum lines in object.
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxl">MAXL</A>=1000000

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxs"><H3>MAXS</H3></A>
 INTEGER-OPTIONAL
 Maximum samples in object
 Default; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#maxs">MAXS</A>=1000000

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects"><H3>OBJECTS</H3></A>
 NAME
 Return of number of
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#objects">objects</A> found to
 script

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid"><H3>ASTEROID</H3></A>
 KEYWORD-OPTIONAL
 The <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">Asteroid</A> keyword
 causes the following 
 6 keywords to be activated.
 These are:
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saominp">SAOMINP</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astminp">ASTMINP</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saoratio">SAORATIO</A>,
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astratio">ASTRATIO</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxw">ASTMAXW</A>,<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxl">ASTMAXL</A>

 VALID=(<A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">ASTEROID</A>,NOAST)
 DEFAULT; NOAST 

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saominp"><H3>SAOMINP</H3></A>
 INTEGER-OPTIONAL
 Candidate STARCAT SAO stars
 must have at least <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saominp">SAOMINP</A>
 pixels.
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saominp">SAOMINP</A>=400

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astminp"><H3>ASTMINP</H3></A>
 INTEGER-OPTIONAL
 Candidate STARCAT asteroids
 must have at least <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astminp">ASTMINP</A>
 pixels.  
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astminp">ASTMINP</A>=35

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saoratio"><H3>SAORATIO</H3></A>
 REAL-OPTIONAL
 Candidate STARCAT SAO stars
 must have at least a narrow
 axis to wide axis ratio of
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saoratio">SAORATIO</A>.
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#saoratio">SAORATIO</A>=0.7

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astratio"><H3>ASTRATIO</H3></A>
 REAL-OPTIONAL
 Candidate STARCAT asteroids
 must have less than a narrow
 axis to wide axis ratio of
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astratio">ASTRATIO</A>.
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astratio">ASTRATIO</A>=0.27

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxw"><H3>ASTMAXW</H3></A>
 REAL-OPTIONAL
 The maximum allowed width for
 an object to be considered an
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">asteroid</A> candidate in the
 STARCAT catalogue.
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxw">ASTMAXW</A>=1.6

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxl"><H3>ASTMAXL</H3></A>
 REAL-OPTIONAL
 The maximum allowed length for
 an object to be considered an
 <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#asteroid">asteroid</A> candidate in the
 STARCAT catalogue.
 DEFAULT; <A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3_level2.html#astmaxl">ASTMAXL</A>=35.

<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3.html#examples"><H4>See Examples:</H4></A>
<HR><A HREF="/VICAR-DOCS/vicar/coredev/html/vichelp/starcat3.html#CogProg"><H4>Cognizant Programmer:</H4></A>
</BODY>
</HTML>
